# AgileFlow: Data Documentation

This document provides a detailed breakdown of the data structures, entities, and their relationships within the AgileFlow application. It serves as a technical reference for understanding how data flows through the system and interacts with internal and external services.

## User Entity

The `User` is the central entity in the AgileFlow application. A user's identity, roles, and preferences dictate their experience and permissions throughout the system.

### User Profile Data

This table details the information stored directly within each `User` object.

| Data Point | Description & Link to Services |
| :--- | :--- |
| `userId: string` | **Internal.** A unique identifier for each user. This is the primary key used to link a user to all other parts of the system. |
| `displayName: string` | **Internal / Google Service.** The user's full name. While currently internal, this is designed to be populated from the **Google User Profile** upon a "Sign in with Google" action. |
| `email: string` | **Internal / Google Service.** The user's email address. This is the primary field used for login. The "Sign in with Google" button uses **Firebase Authentication** with the **Google Auth Provider** to verify this email. |
| `title?: string` | **Internal.** The user's professional title (e.g., "Lead Engineer," "Producer"). This field is specific to AgileFlow and is not sourced from the user's Google Account. |
| `avatarUrl?: string` | **Internal / Google Service.** A URL to the user's profile picture. While currently using placeholders, this is designed to be populated from the **Google User Profile** picture upon a "Sign in with Google" action. |
| `phone?: string` | **Internal.** The user's contact phone number. This field is specific to AgileFlow and is not sourced from the user's Google Account. |
| `location?: string` | **Internal.** The user's primary work location. This field is specific to AgileFlow and is not sourced from the user's Google Account. |
| `googleCalendarLinked: boolean` | **Google Service.** A flag that is set to `true` only after the user successfully completes an OAuth consent flow via **Firebase Authentication** to grant the app permission to access their Google Calendar. |
| `roles?: string[]` | **Internal.** An array of role names assigned to the user. This critical field mixes system-level roles (like `Admin`) with team-specific roles (like `Camera` or `Audio`) to determine permissions. |
| `directReports?: string[]` | **Internal.** An array of `userId`s for users who report directly to this user. This is currently informational. |
| `theme?: 'light' \| 'dark' \| ...` | **Internal.** A UI preference for the app's color scheme. |
| `defaultCalendarView?: 'month' \| 'week' \| ...` | **Internal.** A UI preference for the default calendar layout. |
| `easyBooking?: boolean` | **Internal.** A UI preference for enabling quick event creation from the calendar. |
| `timeFormat?: '12h' \| '24h'` | **Internal.** A UI preference for displaying time in 12-hour or 24-hour format. |

### Associated Data & Relationships

This section describes how a `User`'s actions connect them to other data entities and external services.

| Action / Context | Component & Connection to Services |
| :--- | :--- |
| **Login** | The `LoginForm`'s "Sign in with Google" button triggers **Firebase Authentication**. This service handles the entire OAuth flow with Google, authenticating the user and providing the app with a secure token and basic profile information. |
| **Event Creation & Google Meet** | In the `EventForm`, the "Meet link" option calls the `createMeetLink` Genkit AI flow. In a production system, this flow would make an authenticated call to the **Google Calendar API** to create an event and generate a Google Meet URL. The prototype currently simulates this. |
| **Linking Google Calendar** | In `UserManagement`, clicking to connect a calendar initiates the `linkGoogleCalendar` function. This uses **Firebase Authentication** to specifically request the `calendar.readonly` scope from Google, which is required to read a user's calendar data. |
| **Team Membership** | A user is associated with a `Team` via the `members`, `managers`, and `locationCheckManagers` arrays within the `Team` object. |
| **Event Association** | A user is linked to an `Event` as its `createdBy`, as an `attendee`, or through `roleAssignments`. |
| **Task Association** | A user is linked to a `Task` as its `createdBy` or through the `assignedTo` array. |
| **Notification Source** | A user is the source of notifications generated by their actions (e.g., "Alice Johnson mentioned you..."). Admins receive system-level notifications like access requests. |